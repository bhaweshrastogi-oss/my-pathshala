<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Admin Panel | PMpathshala</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='grad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%23667eea'/><stop offset='100%' style='stop-color:%23764ba2'/></linearGradient></defs><rect x='10' y='10' width='80' height='80' rx='16' fill='url(%23grad)'/><rect x='35' y='25' width='30' height='22' rx='4' fill='white' opacity='0.9'/><rect x='20' y='53' width='26' height='22' rx='4' fill='white' opacity='0.8'/><rect x='54' y='53' width='26' height='22' rx='4' fill='white' opacity='0.7'/></svg>">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        * { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-text { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 4px; }
        
        /* Dark Mode */
        .dark body { background-color: #0f172a; }
        .dark .bg-white { background-color: #1e293b !important; }
        .dark .bg-gray-50 { background-color: #0f172a !important; }
        .dark .bg-gray-100 { background-color: #334155 !important; }
        .dark .text-gray-800, .dark .text-gray-700 { color: #e2e8f0 !important; }
        .dark .text-gray-600, .dark .text-gray-500 { color: #94a3b8 !important; }
        .dark nav { background-color: rgba(30, 41, 59, 0.95) !important; }
        .dark .border-gray-200, .dark .border-gray-300 { border-color: #475569 !important; }
        .dark input, .dark select, .dark textarea { 
            background-color: #334155 !important; 
            color: #e2e8f0 !important; 
            border-color: #475569 !important; 
        }
        .dark aside { background-color: #1e293b !important; }
    </style>
</head>
<body class="bg-gray-50 transition-colors duration-300">
    
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-xl p-8 w-full max-w-md transition-colors duration-300">
            <div class="text-center mb-8">
                <div class="w-16 h-16 gradient-bg rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                        <rect x="7" y="2" width="10" height="8" rx="1.5" fill="white" opacity="0.9"/>
                        <rect x="2" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.8"/>
                        <rect x="13" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.7"/>
                    </svg>
                </div>
                <h1 class="text-2xl font-bold text-gray-800">PMpathshala Admin</h1>
                <p class="text-gray-500 mt-2">Sign in to manage practice tests</p>
            </div>
            
            <form onsubmit="adminLogin(event)">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="adminEmail" required 
                            class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            placeholder="admin@pmpathshala.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <input type="password" id="adminPassword" required 
                            class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                            placeholder="••••••••">
                    </div>
                    <button type="submit" id="loginBtn" class="w-full gradient-bg text-white py-3 rounded-xl font-semibold hover:opacity-90 transition">
                        <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                    </button>
                </div>
            </form>
            
            <div id="loginError" class="hidden mt-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm">
                <i class="fas fa-exclamation-circle mr-2"></i><span id="errorMessage"></span>
            </div>
            
            <p class="text-center text-gray-500 text-sm mt-6">
                <a href="index.html" class="text-purple-600 hover:underline"><i class="fas fa-arrow-left mr-1"></i>Back to Website</a>
            </p>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <!-- Top Navigation -->
        <nav class="fixed w-full bg-white/95 backdrop-blur-sm shadow-sm z-50 transition-colors duration-300">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <rect x="7" y="2" width="10" height="8" rx="1.5" fill="white" opacity="0.9"/>
                                <rect x="2" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.8"/>
                                <rect x="13" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.7"/>
                            </svg>
                        </div>
                        <div>
                            <span class="text-xl font-bold gradient-text">PMpathshala</span>
                            <span class="text-xs text-gray-500 block">Admin Panel</span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span id="adminEmailDisplay" class="text-sm text-gray-600 hidden sm:block"></span>
                        <button onclick="toggleTheme()" class="p-2 rounded-full bg-gray-100 hover:bg-gray-200 transition" aria-label="Toggle dark mode">
                            <i class="fas fa-moon text-gray-600" id="themeIcon"></i>
                        </button>
                        <button onclick="logout()" class="bg-red-50 text-red-600 px-4 py-2 rounded-full text-sm font-medium hover:bg-red-100 transition">
                            <i class="fas fa-sign-out-alt mr-2"></i>Logout
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="pt-16 flex">
            <!-- Sidebar -->
            <aside class="fixed left-0 top-16 bottom-0 w-64 bg-white border-r border-gray-200 p-6 overflow-y-auto transition-colors duration-300 hidden md:block">
                <nav class="space-y-2">
                    <button onclick="showSection('dashboard')" class="sidebar-btn w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition" data-section="dashboard">
                        <i class="fas fa-chart-bar w-6"></i>
                        <span>Dashboard</span>
                    </button>
                    <button onclick="showSection('addQuestion')" class="sidebar-btn w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition" data-section="addQuestion">
                        <i class="fas fa-plus-circle w-6"></i>
                        <span>Add Question</span>
                    </button>
                    <button onclick="showSection('viewQuestions')" class="sidebar-btn w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition" data-section="viewQuestions">
                        <i class="fas fa-list w-6"></i>
                        <span>View Questions</span>
                    </button>
                    <button onclick="showSection('bulkUpload')" class="sidebar-btn w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition" data-section="bulkUpload">
                        <i class="fas fa-upload w-6"></i>
                        <span>Bulk Upload</span>
                    </button>
                </nav>
                
                <div class="mt-8 p-4 bg-purple-50 rounded-xl">
                    <h4 class="font-semibold text-purple-800 mb-2">Quick Stats</h4>
                    <div class="text-sm text-purple-600">
                        <p>PM Questions: <span id="pmCount" class="font-bold">0</span></p>
                        <p>AI PM Questions: <span id="aipmCount" class="font-bold">0</span></p>
                    </div>
                </div>
            </aside>

            <!-- Mobile Menu Button -->
            <button onclick="toggleMobileMenu()" class="md:hidden fixed bottom-6 left-6 z-50 w-14 h-14 gradient-bg rounded-full shadow-lg flex items-center justify-center text-white">
                <i class="fas fa-bars text-xl"></i>
            </button>

            <!-- Mobile Menu -->
            <div id="mobileMenu" class="hidden fixed inset-0 bg-black/50 z-40 md:hidden" onclick="toggleMobileMenu()">
                <aside class="absolute left-0 top-0 bottom-0 w-64 bg-white p-6 overflow-y-auto" onclick="event.stopPropagation()">
                    <div class="flex items-center space-x-3 mb-8">
                        <div class="w-10 h-10 gradient-bg rounded-lg flex items-center justify-center">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <rect x="7" y="2" width="10" height="8" rx="1.5" fill="white" opacity="0.9"/>
                                <rect x="2" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.8"/>
                                <rect x="13" y="12" width="9" height="8" rx="1.5" fill="white" opacity="0.7"/>
                            </svg>
                        </div>
                        <span class="text-xl font-bold gradient-text">Admin</span>
                    </div>
                    <nav class="space-y-2">
                        <button onclick="showSection('dashboard'); toggleMobileMenu();" class="w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition">
                            <i class="fas fa-chart-bar w-6"></i>
                            <span>Dashboard</span>
                        </button>
                        <button onclick="showSection('addQuestion'); toggleMobileMenu();" class="w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition">
                            <i class="fas fa-plus-circle w-6"></i>
                            <span>Add Question</span>
                        </button>
                        <button onclick="showSection('viewQuestions'); toggleMobileMenu();" class="w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition">
                            <i class="fas fa-list w-6"></i>
                            <span>View Questions</span>
                        </button>
                        <button onclick="showSection('bulkUpload'); toggleMobileMenu();" class="w-full flex items-center px-4 py-3 rounded-xl text-left hover:bg-purple-50 hover:text-purple-600 transition">
                            <i class="fas fa-upload w-6"></i>
                            <span>Bulk Upload</span>
                        </button>
                    </nav>
                </aside>
            </div>

            <!-- Content Area -->
            <main class="md:ml-64 flex-1 p-6 min-h-screen">
                
                <!-- Dashboard Section -->
                <section id="dashboardSection" class="max-w-6xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Dashboard</h2>
                    
                    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white rounded-2xl p-6 shadow-sm card-hover transition-colors duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Total Questions</p>
                                    <p id="totalQuestions" class="text-3xl font-bold gradient-text">0</p>
                                </div>
                                <div class="w-12 h-12 gradient-bg rounded-xl flex items-center justify-center">
                                    <i class="fas fa-question-circle text-white"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm card-hover transition-colors duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">PM Questions</p>
                                    <p id="pmQuestionsCount" class="text-3xl font-bold text-purple-600">0</p>
                                </div>
                                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                                    <i class="fas fa-layer-group text-purple-600"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm card-hover transition-colors duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">AI PM Questions</p>
                                    <p id="aipmQuestionsCount" class="text-3xl font-bold text-cyan-600">0</p>
                                </div>
                                <div class="w-12 h-12 bg-cyan-100 rounded-xl flex items-center justify-center">
                                    <i class="fas fa-brain text-cyan-600"></i>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl p-6 shadow-sm card-hover transition-colors duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 text-sm">Weeks Covered</p>
                                    <p id="weeksCovered" class="text-3xl font-bold text-green-600">0</p>
                                </div>
                                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                                    <i class="fas fa-calendar-check text-green-600"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm transition-colors duration-300">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Quick Actions</h3>
                        <div class="grid sm:grid-cols-3 gap-4">
                            <button onclick="showSection('addQuestion')" class="p-4 border-2 border-dashed border-purple-200 rounded-xl text-purple-600 hover:bg-purple-50 transition">
                                <i class="fas fa-plus-circle text-2xl mb-2"></i>
                                <p class="font-medium">Add Question</p>
                            </button>
                            <button onclick="showSection('viewQuestions')" class="p-4 border-2 border-dashed border-cyan-200 rounded-xl text-cyan-600 hover:bg-cyan-50 transition">
                                <i class="fas fa-list text-2xl mb-2"></i>
                                <p class="font-medium">View All Questions</p>
                            </button>
                            <button onclick="showSection('bulkUpload')" class="p-4 border-2 border-dashed border-green-200 rounded-xl text-green-600 hover:bg-green-50 transition">
                                <i class="fas fa-upload text-2xl mb-2"></i>
                                <p class="font-medium">Bulk Upload</p>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Add Question Section -->
                <section id="addQuestionSection" class="hidden max-w-3xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Add New Question</h2>
                    
                    <div class="bg-white rounded-2xl p-6 shadow-sm transition-colors duration-300">
                        <form onsubmit="addQuestion(event)" id="questionForm">
                            <div class="grid md:grid-cols-2 gap-6 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Course *</label>
                                    <select id="qCourse" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        <option value="">Select Course</option>
                                        <option value="pm">Basic to Advanced PM</option>
                                        <option value="aipm">AI Product Manager</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Week *</label>
                                    <select id="qWeek" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                        <option value="">Select Week</option>
                                        <option value="1">Week 1</option>
                                        <option value="2">Week 2</option>
                                        <option value="3">Week 3</option>
                                        <option value="4">Week 4</option>
                                        <option value="5">Week 5</option>
                                        <option value="6">Week 6</option>
                                        <option value="7">Week 7</option>
                                        <option value="8">Week 8</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Question *</label>
                                <textarea id="qQuestion" required rows="3" 
                                    class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="Enter your question here..."></textarea>
                            </div>
                            
                            <div class="grid md:grid-cols-2 gap-4 mb-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Option A *</label>
                                    <input type="text" id="qOptionA" required 
                                        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="Option A">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Option B *</label>
                                    <input type="text" id="qOptionB" required 
                                        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="Option B">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Option C *</label>
                                    <input type="text" id="qOptionC" required 
                                        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="Option C">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Option D *</label>
                                    <input type="text" id="qOptionD" required 
                                        class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                        placeholder="Option D">
                                </div>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Correct Answer *</label>
                                <select id="qCorrectAnswer" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <option value="">Select Correct Answer</option>
                                    <option value="A">Option A</option>
                                    <option value="B">Option B</option>
                                    <option value="C">Option C</option>
                                    <option value="D">Option D</option>
                                </select>
                            </div>
                            
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Explanation</label>
                                <textarea id="qExplanation" rows="3" 
                                    class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                    placeholder="Explain why this answer is correct (optional but recommended)"></textarea>
                            </div>
                            
                            <div class="flex gap-4">
                                <button type="submit" id="submitBtn" class="flex-1 gradient-bg text-white py-3 rounded-xl font-semibold hover:opacity-90 transition">
                                    <i class="fas fa-plus mr-2"></i>Add Question
                                </button>
                                <button type="button" onclick="clearForm()" class="px-6 py-3 border-2 border-gray-300 rounded-xl font-semibold text-gray-600 hover:bg-gray-50 transition">
                                    <i class="fas fa-times mr-2"></i>Clear
                                </button>
                            </div>
                        </form>
                        
                        <div id="successMessage" class="hidden mt-4 p-4 bg-green-50 border border-green-200 rounded-xl text-green-600">
                            <i class="fas fa-check-circle mr-2"></i>Question added successfully!
                        </div>
                    </div>
                </section>

                <!-- View Questions Section -->
                <section id="viewQuestionsSection" class="hidden max-w-6xl mx-auto">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">All Questions</h2>
                        <div class="flex gap-3">
                            <select id="filterCourse" onchange="loadQuestions()" class="px-4 py-2 rounded-xl border border-gray-300 text-sm">
                                <option value="">All Courses</option>
                                <option value="pm">Basic to Advanced PM</option>
                                <option value="aipm">AI Product Manager</option>
                            </select>
                            <select id="filterWeek" onchange="loadQuestions()" class="px-4 py-2 rounded-xl border border-gray-300 text-sm">
                                <option value="">All Weeks</option>
                                <option value="1">Week 1</option>
                                <option value="2">Week 2</option>
                                <option value="3">Week 3</option>
                                <option value="4">Week 4</option>
                                <option value="5">Week 5</option>
                                <option value="6">Week 6</option>
                                <option value="7">Week 7</option>
                                <option value="8">Week 8</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="questionsList" class="space-y-4">
                        <div class="text-center py-12 text-gray-500">
                            <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                            <p>Loading questions...</p>
                        </div>
                    </div>
                </section>

                <!-- Bulk Upload Section -->
                <section id="bulkUploadSection" class="hidden max-w-3xl mx-auto">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Bulk Upload Questions</h2>
                    
                    <div class="bg-white rounded-2xl p-6 shadow-sm transition-colors duration-300 mb-6">
                        <h3 class="font-semibold text-gray-800 mb-4">JSON Format</h3>
                        <p class="text-gray-600 mb-4">Upload multiple questions at once using JSON format. Each question should follow this structure:</p>
                        
                        <pre class="bg-gray-100 rounded-xl p-4 text-sm overflow-x-auto mb-4"><code>[
  {
    "course": "pm",
    "week": 1,
    "question": "What does PM stand for?",
    "options": ["Product Manager", "Project Manager", "Program Manager", "All of the above"],
    "correctAnswer": "A",
    "explanation": "PM typically stands for Product Manager in tech companies."
  },
  {
    "course": "aipm",
    "week": 1,
    "question": "What is Machine Learning?",
    "options": ["Option A", "Option B", "Option C", "Option D"],
    "correctAnswer": "B",
    "explanation": "Your explanation here"
  }
]</code></pre>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Paste JSON Data</label>
                            <textarea id="bulkJson" rows="10" 
                                class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent font-mono text-sm"
                                placeholder='[{"course": "pm", "week": 1, "question": "...", "options": ["A", "B", "C", "D"], "correctAnswer": "A", "explanation": "..."}]'></textarea>
                        </div>
                        
                        <button onclick="bulkUpload()" class="w-full gradient-bg text-white py-3 rounded-xl font-semibold hover:opacity-90 transition">
                            <i class="fas fa-upload mr-2"></i>Upload Questions
                        </button>
                        
                        <div id="bulkResult" class="hidden mt-4 p-4 rounded-xl"></div>
                    </div>
                </section>

            </main>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 overflow-y-auto">
        <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transition-colors duration-300">
            <div class="p-6 border-b flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-800">Edit Question</h3>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6">
                <form onsubmit="updateQuestion(event)" id="editForm">
                    <input type="hidden" id="editId">
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Course</label>
                            <select id="editCourse" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                                <option value="pm">Basic to Advanced PM</option>
                                <option value="aipm">AI Product Manager</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Week</label>
                            <select id="editWeek" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                                <option value="1">Week 1</option>
                                <option value="2">Week 2</option>
                                <option value="3">Week 3</option>
                                <option value="4">Week 4</option>
                                <option value="5">Week 5</option>
                                <option value="6">Week 6</option>
                                <option value="7">Week 7</option>
                                <option value="8">Week 8</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Question</label>
                        <textarea id="editQuestion" required rows="2" class="w-full px-4 py-2 rounded-xl border border-gray-300"></textarea>
                    </div>
                    
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Option A</label>
                            <input type="text" id="editOptionA" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Option B</label>
                            <input type="text" id="editOptionB" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Option C</label>
                            <input type="text" id="editOptionC" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Option D</label>
                            <input type="text" id="editOptionD" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Correct Answer</label>
                        <select id="editCorrectAnswer" required class="w-full px-4 py-2 rounded-xl border border-gray-300">
                            <option value="A">Option A</option>
                            <option value="B">Option B</option>
                            <option value="C">Option C</option>
                            <option value="D">Option D</option>
                        </select>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Explanation</label>
                        <textarea id="editExplanation" rows="2" class="w-full px-4 py-2 rounded-xl border border-gray-300"></textarea>
                    </div>
                    
                    <div class="flex gap-4">
                        <button type="submit" class="flex-1 gradient-bg text-white py-3 rounded-xl font-semibold hover:opacity-90 transition">
                            <i class="fas fa-save mr-2"></i>Save Changes
                        </button>
                        <button type="button" onclick="closeEditModal()" class="px-6 py-3 border-2 border-gray-300 rounded-xl font-semibold text-gray-600 hover:bg-gray-50 transition">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="hidden fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-6 transition-colors duration-300">
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-trash text-red-500 text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold text-gray-800 mb-2">Delete Question?</h3>
                <p class="text-gray-600 mb-6">This action cannot be undone. Are you sure you want to delete this question?</p>
                <div class="flex gap-4">
                    <button onclick="closeDeleteModal()" class="flex-1 px-6 py-3 border-2 border-gray-300 rounded-xl font-semibold text-gray-600 hover:bg-gray-50 transition">
                        Cancel
                    </button>
                    <button onclick="confirmDelete()" class="flex-1 bg-red-500 text-white py-3 rounded-xl font-semibold hover:bg-red-600 transition">
                        <i class="fas fa-trash mr-2"></i>Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        // TODO: Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        let deleteQuestionId = '';

        // ============================================
        // AUTHENTICATION
        // ============================================
        async function adminLogin(event) {
            event.preventDefault();
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;
            const loginBtn = document.getElementById('loginBtn');
            
            loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Signing in...';
            loginBtn.disabled = true;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                showDashboard();
            } catch (error) {
                document.getElementById('loginError').classList.remove('hidden');
                document.getElementById('errorMessage').textContent = getErrorMessage(error.code);
                loginBtn.innerHTML = '<i class="fas fa-sign-in-alt mr-2"></i>Sign In';
                loginBtn.disabled = false;
            }
        }

        function getErrorMessage(code) {
            switch (code) {
                case 'auth/user-not-found': return 'No account found with this email';
                case 'auth/wrong-password': return 'Incorrect password';
                case 'auth/invalid-email': return 'Invalid email address';
                case 'auth/too-many-requests': return 'Too many failed attempts. Try later.';
                default: return 'Login failed. Please try again.';
            }
        }

        function logout() {
            auth.signOut();
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
        }

        // Check auth state on load
        auth.onAuthStateChanged(user => {
            if (user) {
                showDashboard();
            }
        });

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('adminDashboard').classList.remove('hidden');
            document.getElementById('adminEmailDisplay').textContent = auth.currentUser?.email || '';
            loadStats();
            showSection('dashboard');
        }

        // ============================================
        // NAVIGATION
        // ============================================
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(`${section}Section`).classList.remove('hidden');
            
            // Update sidebar active state
            document.querySelectorAll('.sidebar-btn').forEach(btn => {
                btn.classList.remove('bg-purple-50', 'text-purple-600');
                if (btn.dataset.section === section) {
                    btn.classList.add('bg-purple-50', 'text-purple-600');
                }
            });
            
            // Load data if needed
            if (section === 'viewQuestions') loadQuestions();
            if (section === 'dashboard') loadStats();
        }

        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        }

        // ============================================
        // QUESTION MANAGEMENT
        // ============================================
        async function addQuestion(event) {
            event.preventDefault();
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Adding...';
            submitBtn.disabled = true;
            
            const question = {
                course: document.getElementById('qCourse').value,
                week: parseInt(document.getElementById('qWeek').value),
                question: document.getElementById('qQuestion').value,
                options: [
                    document.getElementById('qOptionA').value,
                    document.getElementById('qOptionB').value,
                    document.getElementById('qOptionC').value,
                    document.getElementById('qOptionD').value
                ],
                correctAnswer: document.getElementById('qCorrectAnswer').value,
                explanation: document.getElementById('qExplanation').value,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await db.collection('questions').add(question);
                document.getElementById('successMessage').classList.remove('hidden');
                clearForm();
                loadStats();
                setTimeout(() => {
                    document.getElementById('successMessage').classList.add('hidden');
                }, 3000);
            } catch (error) {
                alert('Error adding question: ' + error.message);
            }
            
            submitBtn.innerHTML = '<i class="fas fa-plus mr-2"></i>Add Question';
            submitBtn.disabled = false;
        }

        function clearForm() {
            document.getElementById('questionForm').reset();
        }

        async function loadQuestions() {
            const filterCourse = document.getElementById('filterCourse').value;
            const filterWeek = document.getElementById('filterWeek').value;
            
            let query = db.collection('questions').orderBy('createdAt', 'desc');
            
            if (filterCourse) query = query.where('course', '==', filterCourse);
            if (filterWeek) query = query.where('week', '==', parseInt(filterWeek));
            
            try {
                const snapshot = await query.get();
                const questionsList = document.getElementById('questionsList');
                
                if (snapshot.empty) {
                    questionsList.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <i class="fas fa-inbox text-4xl mb-4"></i>
                            <p>No questions found</p>
                        </div>
                    `;
                    return;
                }
                
                questionsList.innerHTML = '';
                snapshot.forEach(doc => {
                    const q = doc.data();
                    const courseLabel = q.course === 'pm' ? 'PM' : 'AI PM';
                    const courseClass = q.course === 'pm' ? 'bg-purple-100 text-purple-700' : 'bg-cyan-100 text-cyan-700';
                    
                    questionsList.innerHTML += `
                        <div class="bg-white rounded-xl p-6 shadow-sm transition-colors duration-300">
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="${courseClass} px-3 py-1 rounded-full text-sm font-medium">${courseLabel}</span>
                                <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium">Week ${q.week}</span>
                            </div>
                            <p class="text-gray-800 font-medium mb-3">${q.question}</p>
                            <div class="grid md:grid-cols-2 gap-2 text-sm mb-4">
                                <p class="${q.correctAnswer === 'A' ? 'text-green-600 font-medium' : 'text-gray-600'}">A: ${q.options[0]}</p>
                                <p class="${q.correctAnswer === 'B' ? 'text-green-600 font-medium' : 'text-gray-600'}">B: ${q.options[1]}</p>
                                <p class="${q.correctAnswer === 'C' ? 'text-green-600 font-medium' : 'text-gray-600'}">C: ${q.options[2]}</p>
                                <p class="${q.correctAnswer === 'D' ? 'text-green-600 font-medium' : 'text-gray-600'}">D: ${q.options[3]}</p>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="editQuestion('${doc.id}')" class="px-4 py-2 text-sm bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button onclick="deleteQuestion('${doc.id}')" class="px-4 py-2 text-sm bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition">
                                    <i class="fas fa-trash mr-1"></i>Delete
                                </button>
                            </div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error('Error loading questions:', error);
            }
        }

        async function editQuestion(id) {
            try {
                const doc = await db.collection('questions').doc(id).get();
                const q = doc.data();
                
                document.getElementById('editId').value = id;
                document.getElementById('editCourse').value = q.course;
                document.getElementById('editWeek').value = q.week;
                document.getElementById('editQuestion').value = q.question;
                document.getElementById('editOptionA').value = q.options[0];
                document.getElementById('editOptionB').value = q.options[1];
                document.getElementById('editOptionC').value = q.options[2];
                document.getElementById('editOptionD').value = q.options[3];
                document.getElementById('editCorrectAnswer').value = q.correctAnswer;
                document.getElementById('editExplanation').value = q.explanation || '';
                
                document.getElementById('editModal').classList.remove('hidden');
            } catch (error) {
                alert('Error loading question: ' + error.message);
            }
        }

        async function updateQuestion(event) {
            event.preventDefault();
            const id = document.getElementById('editId').value;
            
            const updates = {
                course: document.getElementById('editCourse').value,
                week: parseInt(document.getElementById('editWeek').value),
                question: document.getElementById('editQuestion').value,
                options: [
                    document.getElementById('editOptionA').value,
                    document.getElementById('editOptionB').value,
                    document.getElementById('editOptionC').value,
                    document.getElementById('editOptionD').value
                ],
                correctAnswer: document.getElementById('editCorrectAnswer').value,
                explanation: document.getElementById('editExplanation').value,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await db.collection('questions').doc(id).update(updates);
                closeEditModal();
                loadQuestions();
                loadStats();
            } catch (error) {
                alert('Error updating question: ' + error.message);
            }
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
        }

        function deleteQuestion(id) {
            deleteQuestionId = id;
            document.getElementById('deleteModal').classList.remove('hidden');
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.add('hidden');
            deleteQuestionId = '';
        }

        async function confirmDelete() {
            try {
                await db.collection('questions').doc(deleteQuestionId).delete();
                closeDeleteModal();
                loadQuestions();
                loadStats();
            } catch (error) {
                alert('Error deleting question: ' + error.message);
            }
        }

        async function bulkUpload() {
            const jsonText = document.getElementById('bulkJson').value;
            const resultDiv = document.getElementById('bulkResult');
            
            try {
                const questions = JSON.parse(jsonText);
                
                if (!Array.isArray(questions)) {
                    throw new Error('Input must be an array of questions');
                }
                
                let successCount = 0;
                let errorCount = 0;
                
                for (const q of questions) {
                    try {
                        await db.collection('questions').add({
                            ...q,
                            week: parseInt(q.week),
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        successCount++;
                    } catch (e) {
                        errorCount++;
                    }
                }
                
                resultDiv.className = 'mt-4 p-4 rounded-xl bg-green-50 border border-green-200 text-green-700';
                resultDiv.innerHTML = `<i class="fas fa-check-circle mr-2"></i>Successfully uploaded ${successCount} questions. ${errorCount > 0 ? `${errorCount} failed.` : ''}`;
                resultDiv.classList.remove('hidden');
                
                document.getElementById('bulkJson').value = '';
                loadStats();
                
            } catch (error) {
                resultDiv.className = 'mt-4 p-4 rounded-xl bg-red-50 border border-red-200 text-red-700';
                resultDiv.innerHTML = `<i class="fas fa-exclamation-circle mr-2"></i>Error: ${error.message}`;
                resultDiv.classList.remove('hidden');
            }
        }

        // ============================================
        // STATS
        // ============================================
        async function loadStats() {
            try {
                const pmSnapshot = await db.collection('questions').where('course', '==', 'pm').get();
                const aipmSnapshot = await db.collection('questions').where('course', '==', 'aipm').get();
                
                const pmCount = pmSnapshot.size;
                const aipmCount = aipmSnapshot.size;
                const total = pmCount + aipmCount;
                
                // Get unique weeks
                const weeks = new Set();
                pmSnapshot.forEach(doc => weeks.add(`pm-${doc.data().week}`));
                aipmSnapshot.forEach(doc => weeks.add(`aipm-${doc.data().week}`));
                
                document.getElementById('totalQuestions').textContent = total;
                document.getElementById('pmQuestionsCount').textContent = pmCount;
                document.getElementById('aipmQuestionsCount').textContent = aipmCount;
                document.getElementById('weeksCovered').textContent = weeks.size;
                document.getElementById('pmCount').textContent = pmCount;
                document.getElementById('aipmCount').textContent = aipmCount;
                
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // ============================================
        // THEME TOGGLE
        // ============================================
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
                themeIcon.classList.remove('fa-sun');
                themeIcon.classList.add('fa-moon');
                localStorage.setItem('theme', 'light');
            } else {
                html.classList.add('dark');
                themeIcon.classList.remove('fa-moon');
                themeIcon.classList.add('fa-sun');
                localStorage.setItem('theme', 'dark');
            }
        }

        if (localStorage.getItem('theme') === 'dark') {
            document.documentElement.classList.add('dark');
            document.getElementById('themeIcon').classList.remove('fa-moon');
            document.getElementById('themeIcon').classList.add('fa-sun');
        }
    </script>
</body>
</html>
